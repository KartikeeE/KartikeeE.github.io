{
  "$schema": "https://vega.github.io/schema/vega-lite/v6.json",
  "width": 720,
  "height": 450,
  "background": "#ffffff",
  "data": {
    "url": "https://raw.githubusercontent.com/KartikeeE/KartikeeE.github.io/main/chart3_gdp_lifeexp_2000_2022.json"
  },
  "transform": [
    { "calculate": "toNumber(datum.year)", "as": "yearNum" },
    { "calculate": "datum['NY.GDP.PCAP.CD']", "as": "gdpPc" },
    { "calculate": "datum['SP.DYN.LE00.IN']", "as": "lifeExp" },
    { "filter": "isValid(datum.gdpPc) && isValid(datum.lifeExp) && datum.gdpPc > 0" },
    { "calculate": "datum.countryName === 'India' ? 'India' : 'Other'", "as": "group" }
  ],
  "layer": [
    {
      "mark": { "type": "line", "strokeWidth": 3, "opacity": 0.7 },
      "encoding": {
        "x": {
          "field": "gdpPc",
          "type": "quantitative",
          "title": "GDP per capita (current US$, log scale)",
          "scale": { "type": "log", "domainMin": 300 }
        },
        "y": {
          "field": "lifeExp",
          "type": "quantitative",
          "title": "Life expectancy (years)",
          "scale": { "domainMin": 55 }
        },
        "detail": { "field": "countryId", "type": "nominal" },
        "color": {
          "field": "group",
          "type": "nominal",
          "legend": null,
          "scale": { "domain": ["India", "Other"], "range": ["#a83250", "#32a85e"] }
        }
      }
    },
    {
      "transform": [{ "filter": "datum.yearNum === 2000" }],
      "mark": { "type": "circle", "size": 120, "opacity": 0.9 },
      "encoding": {
        "x": { "field": "gdpPc", "type": "quantitative", "scale": { "type": "log", "domainMin": 300 } },
        "y": { "field": "lifeExp", "type": "quantitative", "scale": { "domainMin": 55 } },
        "color": {
          "field": "group",
          "type": "nominal",
          "legend": null,
          "scale": { "domain": ["India", "Other"], "range": ["#a83250", "#32a85e"] }
        },
        "tooltip": [
          { "field": "countryName", "type": "nominal", "title": "Country" },
          { "field": "yearNum", "type": "quantitative", "title": "Year" },
          { "field": "gdpPc", "type": "quantitative", "title": "GDP per capita (US$)", "format": ",.0f" },
          { "field": "lifeExp", "type": "quantitative", "title": "Life expectancy", "format": ".1f" }
        ]
      }
    },
    {
      "transform": [{ "filter": "datum.yearNum === 2022" }],
      "mark": { "type": "circle", "size": 220, "opacity": 0.95 },
      "encoding": {
        "x": { "field": "gdpPc", "type": "quantitative", "scale": { "type": "log", "domainMin": 300 } },
        "y": { "field": "lifeExp", "type": "quantitative", "scale": { "domainMin": 55 } },
        "color": {
          "field": "group",
          "type": "nominal",
          "legend": null,
          "scale": { "domain": ["India", "Other"], "range": ["#a83250", "#32a85e"] }
        },
        "tooltip": [
          { "field": "countryName", "type": "nominal", "title": "Country" },
          { "field": "yearNum", "type": "quantitative", "title": "Year" },
          { "field": "gdpPc", "type": "quantitative", "title": "GDP per capita (US$)", "format": ",.0f" },
          { "field": "lifeExp", "type": "quantitative", "title": "Life expectancy", "format": ".1f" }
        ]
      }
    },
    {
      "transform": [{ "filter": "datum.yearNum === 2022" }],
      "mark": { "type": "text", "dx": 10, "dy": -8, "fontSize": 12 },
      "encoding": {
        "x": { "field": "gdpPc", "type": "quantitative" },
        "y": { "field": "lifeExp", "type": "quantitative" },
        "text": { "field": "countryId", "type": "nominal" }
      }
    }
  ],
  "config": {
    "axis": { "grid": false },
    "view": { "stroke": null }
  }
}
